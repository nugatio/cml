%% ----------------------------------------------------------------
%% DOCUMENT CLASS & PACKAGES
%% ----------------------------------------------------------------
\documentclass{sdqbeamer}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{xcolor}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{positioning, arrows.meta, shapes, calc, fit}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}

% Bibliography Setup
\usepackage[citestyle=numeric,bibstyle=numeric,hyperref,backend=biber]{biblatex}
\addbibresource{presentation.bib} % Ensure this file exists
\bibhang1em

%% ----------------------------------------------------------------
%% METADATA
%% ----------------------------------------------------------------

%% Group Logo (Optional)
\grouplogo{kl.png} % Ensure this image exists

%% Group Name
\groupname{Praxis der Forschung -- SotA Presentation}

%% Title & Author
\title[Double Machine Learning for Spatio-Temporal Conflict Data]{Double Machine Learning for Spatio-Temporal Conflict Data}
\subtitle{State-of-the-Art Presentation | Scientific Computing Center (SCC) -- Methods for Big Data}
\author[Niklas Bitzer]{Niklas Bitzer}
\date{14.01.2026}

%% ----------------------------------------------------------------
%% DOCUMENT START
%% ----------------------------------------------------------------
\begin{document}

%% 1. TITLE PAGE
\begin{frame}[title green horizontal, kitlogo=white]
    \titlepage
\end{frame}

%% 2. TABLE OF CONTENTS
\begin{frame}[tableofcontents=green]{Contents}
    \tableofcontents
\end{frame}

%% ----------------------------------------------------------------
%% CONTENT SECTIONS
%% ----------------------------------------------------------------

\section{Introduction}

\begin{frame}{Introduction}{Conflict Data}
    \begin{columns}[t]
        \column{0.48\textwidth}
        \begin{greenblock}{Recent Data Revolution}
            \textbf{Characteristics}
            \begin{itemize}
                \item High-dimensional
                \item Fine-grained
                \item Spatio-temporal
            \end{itemize}
            \textbf{Sources}
            \begin{itemize}
                \item Conflict Event Databases (UCDP GED \cite{sundberg_introducing_2013}; ACLED \cite{raleigh_introducing_2010})
                \item Remote Sensing: Climate variables; Satellite imagery \cite{racek_conflict_2024}
                \item Structural Embeddings: Economic/Social indicators \cite{rod_review_2024}
            \end{itemize}
            \vspace*{\fill}
        \end{greenblock}

        \column{0.48\textwidth}
        \vspace*{-4cm}
        \begin{royalblueblock}{Example from \textcite{racek_capturing_2025}}
            \begin{itemize}
                \item PRIO-GRID covering Africa
                \item $0.5^\circ \times 0.5^\circ$ lattice grid structure ($55 \times 55$ kmÂ² at the equator)
                \item 10,640 grid cells
                \item Monthly data from 2000 to 2020 (252 months)
            \end{itemize}
            \vspace*{\fill}
        \end{royalblueblock}

        \centering
        % Ensure img2.png exists
        \begin{figure}
            \includegraphics[width=0.65\linewidth, height=\textheight, keepaspectratio]{img2.png}
        \end{figure}
    \end{columns}
\end{frame}

\begin{frame}{Introduction}{Application of Conflict Research}
    \begin{columns}[t]
        \column{0.55\textwidth}
        \textbf{Goals:}
        \begin{itemize}
            \item Predict conflict (where and when)
            \item Prevent conflict
            \item Guide post-conflict recovery
            \item \textbf{Explain underlying causal mechanisms}
            \item \textbf{Evaluate causal impact}
            \vspace{0.3em}
        \end{itemize}
        \textbf{Stakeholders:}
        \begin{itemize}
            \item Policymakers
            \item Humanitarian Organizations
            \item Early Warning Systems
        \end{itemize}

        \column{0.42\textwidth}
        \begin{royalblueblock}{Key Areas}
            \textbf{Specific Interventions:}
            \begin{itemize}
                \item Foreign aid allocation \cite{kuzmanovic_causal_2024}
                \item Military actions \cite{papadogeorgou_causal_2022}
            \end{itemize}
            \textbf{External Shocks:}
            \begin{itemize}
                \item Economic shocks \cite{miguel_economic_2004}
                \item Climate events
            \end{itemize}
        \end{royalblueblock}
    \end{columns}
\end{frame}

\begin{frame}{Introduction}{Fundamental Challenges}
    \begin{columns}[t]
        \column{0.31\textwidth}
        \begin{redblock}{1. Interpretability}
            \begin{itemize}
                \item Policymakers take no action without trust \cite{rudin_stop_2019}
                \item Forecasting models identify \textbf{correlates, not causes} \cite{cederman_predicting_2017}
                \item Prediction $\rightarrow$ Explanation is the key challenge
            \end{itemize}
        \end{redblock}

        \column{0.31\textwidth}
        \begin{redblock}{2. Dimensionality}
            \textbf{High-Dimensional Setting \cite{hegre_introducing_2020}}
            \begin{itemize}
                \item Hundreds of confounders
                \item Traditional methods fail
                \item \textbf{Need}: Regularization (Lasso, RF)
                \item \textbf{But}: Regularization $\rightarrow$ Bias \cite{belloni_high-dimensional_2014}
            \end{itemize}
        \end{redblock}

        \column{0.31\textwidth}
        \begin{redblock}{3. Conflict Diffusion}
            \textbf{Spatial Dependencies}
            \begin{itemize}
                \item Spillover effects across grid cells
                \item SUTVA violations (interference) \cite{papadogeorgou_causal_2022}
            \end{itemize}
            \vspace{0.3em}
            \textbf{Temporal Dependencies}
            \begin{itemize}
                \item Conflict persistence
                \item Carryover effects \cite{racek_capturing_2025}
            \end{itemize}
        \end{redblock}
    \end{columns}
\end{frame}

\section{From Forecasting to Causal Inference}

\begin{frame}{From Forecasting to Causal Inference}{SotA in Forecasting}
    \begin{lightgraybox}
        Forecasting has moved beyond small-scale country-specific designs to fine-grained event data \cite{croicu_forecasting_2025}
    \end{lightgraybox}

    \vspace{1em}

    \begin{columns}[t]
        \column{0.48\textwidth}
        \begin{itemize}
            \item \textbf{Methodological Approaches \cite{hegre_202324_2025}:}
            \begin{itemize}
                \item Non-parametric Ensembles: Random Forests, XGBoost
                \item Deep Learning: LSTMs, Transformers (e.g. Temporal Fusion Transformers)
                \item LLMs based on news corpora
            \end{itemize}
            \item VIEWS competition \cite{hegre_202324_2025} represents the benchmark
            \item \textbf{Performance:} High predictive accuracy for static risk assessment
        \end{itemize}

        \column{0.48\textwidth}
        \begin{redblock}{Limitations \cite{cederman_predicting_2017, racek_capturing_2025}}
            \begin{itemize}
                \item Lack interpretability (\textbf{Black Box Models})
                \item Limited capabilities at predicting conflict dynamics (e.g., onsets, escalations)
                \item Spatial dependence often treated as nuisance
                \item Spatial/temporal lags used as simple controls
            \end{itemize}
        \end{redblock}
    \end{columns}
\end{frame}

\begin{frame}{From Forecasting to Causal Inference}{The Missing Causal Understanding}
    \begin{columns}[t]
        \column{0.48\textwidth}
        \begin{blueblock}{Forecasting Goal}
            \textbf{Maximize Predictive Accuracy}
            \begin{itemize}
                \item Objective: $\min \mathbb{E}[(Y - \hat{Y})^2]$
                \item Metrics: AUROC, Brier score
                \item Question: ``What happens next?''
            \end{itemize}
        \end{blueblock}

        \column{0.48\textwidth}
        \begin{blueblock}{Causal Goal}
            \textbf{Identify Treatment Effects}
            \begin{itemize}
                \item Structural Parameter: $\theta_0$ or $\tau(x)$
                \item Valid Inference: $\sqrt{n}(\hat{\theta} - \theta_0) \to \mathcal{N}(0, \Sigma)$
                \item Question: ``What if we intervene?''
            \end{itemize}
        \end{blueblock}
    \end{columns}

    \vspace{1em}

    \begin{redblock}{Good Prediction is not Enough}
        \begin{itemize}
            \item Distinct epistemological goals \cite{shmueli_explain_2010}
            \item Correlation $\neq$ Causation
            \item ``Theory-free prediction does little to guide intervention without knowledge about the drivers of conflict'' \cite[p.23]{cederman_predicting_2017}
            \item Policy decisions require \textbf{counterfactual reasoning} \cite{feuerriegel_causal_2024}
        \end{itemize}
    \end{redblock}
\end{frame}

\begin{frame}{From Forecasting to Causal Inference}{Causal Machine Learning}
    \begin{columns}
        \column{0.95\textwidth}
        \begin{redblock}{The Fundamental Problem of Causal Inference \cite{holland_statistics_1986}}
            The inability to observe both treated and untreated potential outcomes for the same unit simultaneously
        \end{redblock}
    \end{columns}

    \vspace{1em}

    \begin{columns}[t]
        \column{0.48\textwidth}
        \textbf{The Approach \cite{athey_machine_2019}:}
        \begin{itemize}
            \item Combines flexible estimation of ML with principles from causal inference
            \item Builds on potential outcomes framework
            \item Enables effect estimation for high-dimensional covariates \& complex non-linear relations
        \end{itemize}

        \column{0.48\textwidth}
        \textbf{Heterogeneity:} \\
        New methodological approaches focus on \textbf{Heterogeneous Treatment Effects (HTE)} by estimating the \textbf{Conditional Average Treatment Effect (CATE)} \cite{kunzel_metalearners_2019}
        \vspace{0.8em}

        \textbf{Taxonomy:}
        \begin{itemize}
            \item Tree-based methods (Causal Forests \cite{wager_estimation_2017})
            \item Meta-learners (T/S/X-Learner) \cite{kunzel_metalearners_2019}
            \item Orthogonalization (DML \cite{chernozhukov_doubledebiased_2018})
        \end{itemize}
    \end{columns}
\end{frame}

\section{Spatio-Temporal Causal Inference}

\begin{frame}{Spatio-Temporal Causal Inference}{SUTVA Violation}
    \begin{columns}[T]
        \column{0.65\textwidth}

        \textbf{The Assumption:} Stable Unit Treatment Value Assumption (SUTVA)
        \begin{equation*}
            Y_i(d_1, \dots, d_N) = Y_i(d_i) \quad \text{(Independence of units)}
        \end{equation*}
        % NOTE: Changed w_i to d_i to match later DML slides

        \textbf{Fails for Conflict Data \cite{racek_capturing_2025}}
        \begin{itemize}
            \item \textbf{Spillover (Spatial Interference)}
            % Treatment in cell A affects outcome in cell B
            \item \textbf{Carryover (Temporal Persistence)}
            % Effects of an intervention persist even after treatment has ended
        \end{itemize}

        \vspace{0.5em}
        \begin{greenblock}{Explicit Modelling}
            \begin{itemize}
                \item Network/Dependency Graph \cite{leung_treatment_2020}
                \item Geometry/Ring Methods \cite{pollmann_causal_2023}
                \item Nonparametric Smoothing \cite{racek_capturing_2025}
                \item Stochastic Point Processes \cite{papadogeorgou_causal_2022}
            \end{itemize}
        \end{greenblock}

        \column{0.35\textwidth}
        \vspace*{-4cm}
        \centering
        % Ensure img1.png exists
        \begin{figure}
            \includegraphics[width=\linewidth, height=0.9\textheight, keepaspectratio]{img1.png}
        \end{figure}
    \end{columns}
\end{frame}

\begin{frame}{Spatio-Temporal Causal Inference}{Spatial Confounding}
    \begin{columns}[T]
        \column{0.55\textwidth}
        \textbf{Interference vs. Confounding}
        \begin{itemize}
            \item Interference: Outcomes spill over
            \item Confounding: Clusters in space
        \end{itemize}
        \vspace*{0.5em}
        \textbf{The Assumption:} Unconfoundedness (Ignorability)
        \begin{redblock}{Fails for Spatial Data \cite{ali_tutorial_2024, reich_review_2021}}
            \textbf{Spatial Confounding:} Unmeasured variables $U$ with spatial structure affect both treatment and outcome.
            \begin{itemize}
                \item Conflict drivers are not randomly distributed
                \item \textbf{Latent Variables ($U_i$):} Governance \cite{dorazio_modeling_2019}, terrain \cite{obukhov_identifying_2023}, ethnic tensions, culture
                \item $\Rightarrow$ Spurious treatment-outcome association
            \end{itemize}
        \end{redblock}

        \column{0.41\textwidth}
        \centering
        \begin{tikzpicture}[
            node distance=2cm,
            box/.style={rectangle, draw, minimum width=2cm, minimum height=1.5cm, font=\small},
            latent/.style={circle, draw, dashed, minimum size=2cm, font=\small},
            arrow/.style={->, >=stealth, thick}
        ]
            % Replaced W with D for consistency
            \node[box] (D) {$D$};
            \node[box, right=of D] (Y) {$Y$};
            \node[box, above=0.8cm of D] (X) {$X$};
            \node[latent, above=0.8cm of Y] (U) {$U$};

            \draw[arrow] (D) -- (Y);
            \draw[arrow] (X) -- (D);
            \draw[arrow] (X) -- (Y);
            \draw[arrow, color=kit-red100] (U) -- (D);
            \draw[arrow, color=kit-red100] (U) -- (Y);
        \end{tikzpicture}
        \vspace{1.25em}
        \begin{greenblock}{Mitigation Strategies}
            \begin{itemize}
                \item Spatial Fixed Effects (if static) \cite{clarke_double_2025}
                \item Spatial Basis Functions \cite{conley_standard_2025}
                \item Geographic Grouping
            \end{itemize}
        \end{greenblock}
    \end{columns}
\end{frame}

\begin{frame}{Spatio-Temporal Causal Inference}{Other Challenges}
    % CHECK: Notation updated to D for treatment to match DML section
    \begin{columns}[T]
        \column{0.48\textwidth}

        \begin{redblock}{i.i.d. Assumption Violated \cite{semenova_inference_2023}}
            \textbf{Standard ML \& Inference assume:}
            \begin{equation*}
                (Y_i, D_i, X_i) \overset{\text{i.i.d.}}{\sim} P
            \end{equation*}

            \textbf{Spatio-temporal data:}
            \begin{equation*}
                \text{Cov}(Y_{it}, Y_{js}) \neq 0
            \end{equation*}
            % {\small for units $i, j$ nearby or times $t, s$ close}
        \end{redblock}

        \column{0.48\textwidth}

        \begin{royalblueblock}{Dynamic Treatment Effects}
            Effects unfold over time (Distributed Lag):
            \begin{equation*}
                Y_{it} = \sum_{\ell=0}^{L} \theta_\ell \, D_{i,t-\ell} + g_0(X_{it}) + \varepsilon_{it}
            \end{equation*}
        \end{royalblueblock}

        \vspace{0.3em}

        \begin{redblock}{Challenges}
            \begin{itemize}
                \item \textbf{Carryover Effects:} $D_{t-1} \to Y_t$
                \item \textbf{Feedback Loops:} $Y_{t-1} \to D_t$
                \item \textbf{Time-varying confounding}
            \end{itemize}
        \end{redblock}
    \end{columns}
\end{frame}

\section{Double Machine Learning}

\begin{frame}{Double Machine Learning}{The Basics \cite{chernozhukov_doubledebiased_2018}}
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
           \textbf{The Problem:}
           \begin{itemize}
               \item Naive ML estimation of $\eta$ introduces regularization bias
               \item $\Rightarrow$ Slower than $\sqrt{N}$ convergence for $\hat{\theta}$
           \end{itemize}

           \vspace{0.5cm}
            \begin{greenblock}{Neyman Orthogonality}
                Score $\psi$ is Neyman orthogonal if the moment condition is insensitive to local perturbations in the nuisance parameter $\eta$:
                $$ \partial_{\eta} \mathbb{E}[\psi(W; \theta_0, \eta_0)][\eta - \eta_0] = 0 $$
                \textbf{Result:} We can plug in noisy estimates $\hat{\eta}$ without creating first-order bias
            \end{greenblock}
        \end{column}

        \begin{column}{0.48\textwidth}
            \begin{center}
                \textbf{The DML Algorithm:}
            \end{center}
            \begin{enumerate}
                \item \textbf{Split} data into $K$ folds (Cross-Fitting)
                \item \textbf{Predict} nuisances using ML:
                \[ \hat{Y} = \hat{g}(X), \quad \hat{D} = \hat{m}(X) \]
                \item \textbf{Residualize}:
                \[ \tilde{Y} = Y - \hat{Y}, \quad \tilde{D} = D - \hat{D} \]
                \item \textbf{Regress} residuals to find causal effect:
                \[ \tilde{Y} = \theta \tilde{D} + \epsilon \]
            \end{enumerate}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Double Machine Learning}{Cross-Fitting for Spatio-Temporal Data}
    \begin{columns}[T]
        \begin{column}{0.56\textwidth}
            Standard DML assumes independent observations (i.i.d.).
            Our data is:
            \begin{itemize}
                \item \textbf{Spatially Correlated:} Conflict spills over borders.
                \item \textbf{Temporally Dependent:} History matters.
            \end{itemize}

            \vspace{0.3cm}
            \begin{greenblock}{Solutions}
                \begin{itemize}
				\item \textbf{Neighbor Left Out CF:} Leave out neighbors when fitting nuisance components \cite{semenova_inference_2023}
                    \item \textbf{Block Cross-Fitting:}
                    Split by Time Blocks or Spatial Clusters to preserve dependence structure \cite{clarke_double_2025}
                    \item \textbf{Multiway Clustering:}
                    Standard errors must be clustered by Grid ID and Time ID \cite{chiang_multiway_2022}
                \end{itemize}
            \end{greenblock}
        \end{column}

        \begin{column}{0.40\textwidth}
            \centering
            \begin{tikzpicture}[xscale=2, yscale=0.8]
                % Fold 1
                \draw[fill=blue!10, thick] (0,1) rectangle (4,2);
                \node at (2,1.5) {\textbf{Full Sample $N$}};

                % Arrow
                \draw[->, thick] (2,1) -- (2,0);

                % Splits
                \draw[fill=orange!20, thick] (0,-1.5) rectangle (2,-0.5);
                \node at (1,-1) {Auxiliary ($I^c$)};
                \node[below, font=\footnotesize] at (1,-1.5) {\textbf{Train ML} ($\hat{g}, \hat{m}$)};

                \draw[fill=green!20, thick] (2,-1.5) rectangle (4,-0.5);
                \node at (3,-1) {Main ($I$)};
                \node[below, font=\footnotesize] at (3,-1.5) {\textbf{Estimate} $\hat{\theta}$};
            \end{tikzpicture}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Double Machine Learning}{Methodologies \& Research Questions}
    \vspace{1em}
    \begin{columns}[t]
        \column{0.31\textwidth}
        \begin{blueblock}{RQ1: Drivers}
            \centering \textbf{Standard DML} \\ (PLR)
            \vspace{0.5em}
            \begin{itemize}
                \item Which explainable causes drive the spatio-temporal diffusion of armed conflict?
                \item \textbf{Challenges:} Spatial Confounding, Identifiability
            \end{itemize}
        \end{blueblock}

        \column{0.31\textwidth}
        \begin{blueblock}{RQ2: Diffusion over Time}
            \centering \textbf{DML \& DTE} \\ (Panel Data)
            \vspace{0.5em}
            \begin{itemize}
                \item How does the treatment effect diffuse conflicts over time?
                \item \textbf{Challenges:} Dynamic Confounding, Impulse Response
            \end{itemize}
        \end{blueblock}

        \column{0.31\textwidth}
        \begin{blueblock}{RQ3: Interactions}
            \centering \textbf{DML \& HTE} \\ (CATE)
            \vspace{0.5em}
            \begin{itemize}
                \item Which covariates have an interaction effect with the treatment's diffusion?
                \item \textbf{Challenges:} High-Dimensionality, Identifiability
            \end{itemize}
        \end{blueblock}
    \end{columns}
\end{frame}

\begin{frame}{Double Machine Learning}{DML for Dynamic Treatment Effects \cite{lewis_doubledebiased_2021}}
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \textbf{Partially Linear Markovian Model}
            \vspace{0.2cm}

            Treatments over time affect future:
            \begin{itemize}
                \item states (through system dynamics)
                \item treatments (through policy)
                \item outcomes (directly + indirectly)
            \end{itemize}

            \vspace{0.2cm}

            \textbf{Goal:} Estimate effect of treatment at period $t$ on final outcome at different time lags

            \vspace{0.2cm}

            \textbf{Key Innovation:} Sequential peeling to isolate causal effects at each lag
            \vspace{0.3cm}
        \end{column}

        \begin{column}{0.48\textwidth}
            \begin{royalblueblock}{Dynamic DML Algorithm}
                \textbf{For each time lag}:
                \vspace{0.2cm}

                \textbf{1. Residualize outcome}
                \begin{itemize}
                    \item ML to predict final outcome from state
                    \item Compute outcome residuals
                \end{itemize}

                \textbf{2. Residualize treatments}
                \begin{itemize}
                    \item ML to predict past treatments from state
                    \item Compute treatment residuals
                \end{itemize}

                \textbf{3. Estimate effect}
                \begin{itemize}
                    \item Regress outcome residuals on treatment residuals
                    \item Account for previously estimated lags
                \end{itemize}
                \vspace{0.2cm}
            \end{royalblueblock}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}{Double Machine Learning}{DML for Heterogeneous Treatment Effects \cite{chernozhukov_generic_2025, semenova_debiased_2021}}
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \begin{royalblueblock}{Conditional Average Treatment Effect (CATE)}
                \textbf{CATE:} $\tau(x) = \mathbb{E}[Y_i(1) - Y_i(0) \mid X_i = x]$
                \vspace{0.2cm}

                Treatment effect for units with characteristics $x$.

                \textbf{Problem:}
                \begin{itemize}
                    \item True CATE is not readily observable
                    \item Infinite-dimensional (only aggregated measures)
                \end{itemize}
                \textbf{Solution:} Approximate with low-dimensional projection
            \end{royalblueblock}

            \vspace{0.2cm}

            \begin{royalblueblock}{Best Linear Predictor (BLP)}
                \textbf{Approximate:}
                \begin{equation*}
                    \tau(x) \approx \alpha + \beta_1 x_1 + \dots + \beta_p x_p
                \end{equation*}
                with $\alpha$ as ATE and $\beta_j$ showing how $x_j$ modifies the effect
            \end{royalblueblock}
        \end{column}

        \begin{column}{0.48\textwidth}
                \textbf{Step 1: Nuisance Estimation (ML)}
                \begin{itemize}
                    \item Split sample (Cross-Fitting)
                    \item Predict outcome $\hat{g}(Z) = \mathbb{E}[Y|Z]$
                    \item Predict treatment $\hat{m}(Z) = \mathbb{E}[D|Z]$
                \end{itemize}

                \textbf{Step 2: Orthogonalization}
                Compute residuals to remove confounding:
                \begin{equation*}
                    \tilde{Y} = Y - \hat{g}(Z), \quad \tilde{D} = D - \hat{m}(Z)
                \end{equation*}

                \textbf{Step 3: Linear Projection}
                Regress outcome residuals on treatment interactions:
                \begin{equation*}
                    \tilde{Y} = \alpha \tilde{D} + \sum \beta_j (\tilde{D} \cdot x_j) + \epsilon
                \end{equation*}
        \end{column}
    \end{columns}
\end{frame}

\appendix
\beginbackup

\begin{frame}[allowframebreaks, noframenumbering]{References}
    \printbibliography
\end{frame}

\backupend

\end{document}
